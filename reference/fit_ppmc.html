<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='For models estimated with method = "mcmc", use the posterior distributions
to compute expected distributions for fit statistics and compare to values
in the observed data.'><title>Posterior predictive model checks for assessing model fit — fit_ppmc • measr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.5/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.5/font.css" rel="stylesheet"><link href="../deps/Playfair_Display-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Posterior predictive model checks for assessing model fit — fit_ppmc"><meta property="og:description" content='For models estimated with method = "mcmc", use the posterior distributions
to compute expected distributions for fit statistics and compare to values
in the observed data.'><meta property="og:image" content="https://measr.info/reference/figures/card.png"><meta property="og:image:alt" content=""><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@wjakethompson"><meta name="twitter:site" content="@atlas4learning"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">measr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/measr.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/model-estimation.html">Estimating diagnostic classification models</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wjakethompson/measr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Posterior predictive model checks for assessing model fit</h1>
      <small class="dont-index">Source: <a href="https://github.com/wjakethompson/measr/blob/HEAD/R/ppmc.R" class="external-link"><code>R/ppmc.R</code></a></small>
      <div class="d-none name"><code>fit_ppmc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For models estimated with <code>method = "mcmc"</code>, use the posterior distributions
to compute expected distributions for fit statistics and compare to values
in the observed data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_ppmc</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  ndraws <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>  return_draws <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  model_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"raw_score"</span><span class="op">)</span>,</span>
<span>  item_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"conditional_prob"</span>, <span class="st">"odds_ratio"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>model</dt>
<dd><p>A <a href="measrfit-class.html">measrfit</a> object.</p></dd>


<dt>ndraws</dt>
<dd><p>The number of posterior draws to base the checks on. Must be
less than or equal to the total number of posterior draws retained in the
estimated model. If <code>NULL</code> (the default) the total number from the
estimated model is used.</p></dd>


<dt>probs</dt>
<dd><p>The percentiles to be computed by the <code>[stats::quantile()]</code>
function for summarizing the posterior distributions of the specified fit
statistics.</p></dd>


<dt>return_draws</dt>
<dd><p>Proportion of posterior draws for each specified fit
statistic to be returned. This does not affect the calculation of the
posterior predictive checks, but can be useful for visualizing the fit
statistics. For example, if <code>ndraws = 500</code>, <code>return_draws = 0.2</code>, and
<code>model_fit = "raw_score"</code>, then the raw score chi-square will be computed
500 times (once for each draw) and 100 of those values (0.2 * 500) will be
returned. If <code>0</code> (the default), only summaries of the posterior are
returned (no individual samples).</p></dd>


<dt>model_fit</dt>
<dd><p>The posterior predictive model checks to compute for an
evaluation of model-level fit. If <code>NULL</code>, no model-level checks are
computed. See details.</p></dd>


<dt>item_fit</dt>
<dd><p>The posterior predictive model checks to compute for an
evaluation of item-level fit. If <code>NULL</code>, no item-level checks are computed.
Multiple checks can be provided in order to calculate more than one check
simultaneously (e.g., <code>item_fit = c("conditional_prob", "odds_ratio")</code>).
See details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with two elements, "model_fit" and "item_fit". If either
<code>model_fit = NULL</code> or <code>item_fit = NULL</code> in the function call, this will be
a one-element list, with the null criteria excluded. Each list element, is
itself a list with one element for each specified PPMC containing a
<a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a>. For example if
<code>item_fit = c("conditional_prob", "odds_ratio")</code>, the "item_fit" element
will be a list of length two, where each element is a tibble containing the
results of the PPMC. All tibbles follow the same general structure:</p><ul><li><p><code>obs_{ppmc}</code>: The value of the relevant statistic in the observed data.</p></li>
<li><p><code>ppmc_mean</code>: The mean of the <code>ndraws</code> posterior samples calculated for
the given statistic.</p></li>
<li><p>Quantile columns: 1 column for each value of <code>probs</code>, providing the
corresponding quantiles of the <code>ndraws</code> posterior samples calculated for
the given statistic.</p></li>
<li><p><code>samples</code>: A list column, where each element contains a vector of length
<code>(ndraws * return_draws)</code>, representing samples from the posterior
distribution of the calculated statistic. This column is excluded if
<code>return_draws = 0</code>.</p></li>
<li><p><code>ppp</code>: The posterior predictive p-value. This is the proportion of
posterior samples for calculated statistic that are greater than the
observed value. Values very close to 0 or 1 indicate incompatibility
between the fitted model and the observed data.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Posterior predictive model checks (PPMCs) use the posterior distribution of
an estimated model to compute different statistics. This creates an expected
distribution of the given statistic, <em>if our estimated parameters are
correct</em>. We then compute the statistic in our observed data and compare the
observed value to the expected distribution. Observed values that fall
outside of the expected distributions indicate incompatibility between the
estimated model and the observed data.</p>
<p>We currently support PPMCs at the model and item level. At the model level,
we calculate the expected raw score distribution (<code>model_fit = "raw_score"</code>),
as described by Thompson (2019) and Park et al. (2015).</p>
<p>At the item level, we can calculate the conditional probability that a
respondent in each class provides a correct response (<code>item_fit = "conditional_prob"</code>) as described by Thompson (2019) and Sinharay &amp; Almond
(2007). We can also calculate the odds ratio for each pair of items
(<code>item_fit = "odds_ratio"</code>) as described by Park et al. (2015) and Sinharay
et al. (2006).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Park, J. Y., Johnson, M. S., Lee, Y-S. (2015). Posterior
predictive model checks for cognitive diagnostic models. <em>International
Journal of Quantitative Research in Education, 2</em>(3-4), 244-264.
<a href="https://doi.org/10.1504/IJQRE.2015.071738" class="external-link">doi:10.1504/IJQRE.2015.071738</a></p>
<p>Sinharay, S., &amp; Almond, R. G. (2007). Assessing fit of cognitive
diagnostic models. <em>Educational and Psychological Measurement, 67</em>(2),
239-257. <a href="https://doi.org/10.1177/0013164406292025" class="external-link">doi:10.1177/0013164406292025</a></p>
<p>Sinharay, S., Johnson, M. S., &amp; Stern, H. S. (2006). Posterior
predictive assessment of item response theory models. <em>Applied
Psychological Measurement, 30</em>(4), 298-321.
<a href="https://doi.org/10.1177/0146621605285517" class="external-link">doi:10.1177/0146621605285517</a></p>
<p>Thompson, W. J. (2019). <em>Bayesian psychometrics for diagnostic
assessments: A proof of concept</em> (Research Report No. 19-01). University
of Kansas; Accessible Teaching, Learning, and Assessment Systems.
<a href="https://doi.org/10.35542/osf.io/jzqs8" class="external-link">doi:10.35542/osf.io/jzqs8</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># interactive()</span></span></span>
<span class="r-in"><span><span class="va">cmds_mdm_dina</span> <span class="op">&lt;-</span> <span class="fu"><a href="measr_dcm.html">measr_dcm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">mdm_data</span>, missing <span class="op">=</span> <span class="cn">NA</span>, qmatrix <span class="op">=</span> <span class="va">mdm_qmatrix</span>,</span></span>
<span class="r-in"><span>  resp_id <span class="op">=</span> <span class="st">"respondent"</span>, item_id <span class="op">=</span> <span class="st">"item"</span>, type <span class="op">=</span> <span class="st">"dina"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"mcmc"</span>, seed <span class="op">=</span> <span class="fl">63277</span>, backend <span class="op">=</span> <span class="st">"rstan"</span>,</span></span>
<span class="r-in"><span>  iter <span class="op">=</span> <span class="fl">700</span>, warmup <span class="op">=</span> <span class="fl">500</span>, chains <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">fit_ppmc</span><span class="op">(</span><span class="va">cmds_mdm_dina</span>, model_fit <span class="op">=</span> <span class="st">"raw_score"</span>, item_fit <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://wjakethompson.com" class="external-link">W. Jake Thompson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>The research reported here was supported by the Institute of Education Sciences, U.S. Department of Education, through Grant <a href="https://ies.ed.gov/funding/grantsearch/details.asp?ID=4546" class="external-link">R305D210045</a> to the University of Kansas. The opinions expressed are those of the authors and do not represent the views of the the Institute or the U.S. Department of Education.</p>
</div>

    </footer></div>

  

  

  </body></html>

